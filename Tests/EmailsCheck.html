<iframe src="" frameborder="0"></iframe>
<!doctype html>
<html lang="en">
<!--
This version of the SP Mass deletion tool for users is adapted to work with most versions of SP 2010 and 2013
It uses asynchronous requests
-->

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Mass Deletion 2010-2013</title>
    <script type="text/javascript" src="https://googledrive.com/host/0B05gvY7cupTteG90ejJhVllWZ1k/jquery.js"></script>
    <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.css" />
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://googledrive.com/host/0B05gvY7cupTtTnJfX2I1XzNtdkE/main.css">
    <link rel="stylesheet" href="https://googledrive.com/host/0B05gvY7cupTtTnJfX2I1XzNtdkE/normalize.css">

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.7.1/modernizr.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.71/jquery.csv-0.71.min.js"></script>
    <script type="text/javascript" src="https://googledrive.com/host/0B05gvY7cupTteG90ejJhVllWZ1k/jquery.SPServices.min.js"></script>
    <script type="text/javascript" src="https://googledrive.com/host/0B05gvY7cupTteG90ejJhVllWZ1k/sharepointplus.js"></script>
    <script type="text/javascript" src="libraries/2.2/sheetjs.all.min.js"></script>
    <script type="text/javascript" src="libraries/2.2/excelplus-2.2.min.js"></script>
    <script type="text/javascript" src="libraries/zeroclipboard-2.2.0/dist/ZeroClipboard.js"></script>
    <script type="text/javascript" src="js/User.js"></script>
    <script type="text/javascript" src="js/massDelete2.js"></script>
    <style>
        #wrapper{
            width: 70%;
            margin: auto;
        }
        ol{
            border: 1px solid black;

        }
        #valid, #invalid{
            display: inline-block;
            width: 40%;
        }
        p{
            cursor: pointer;
        }
    </style>
</head>

<body>
    <div id="wrapper">
        <div>
            <object id="file-object"></object>
        </div>
        <div id="valid">
            <p>valid users</p>
            <ol id="valid-list">
            </ol>
        </div>
        <div id="invalid">
            <p>Invalid users</p>
            <ol id="invalid-list">
            </ol>
            <button id="d_clip_button"  data-clipboard-target='invalid-list' data-clipboard-text='Default clipboard text from attribute' title='Click me to copy to clipboard.'> Copy selection </button>
        </div>
        <button id="delete-users">Delete Users</button>
    </div>
   
    <script type="text/javascript">

      

        
            //One access
            //check group permissions
            var subjectGroups = [];
            var usersInGroup = new Array();

            // $().SPServices({
            //     operation: "GetGroupCollectionFromWeb",
            //     webURL: "http://ent261.sharepoint.hp.com/teams/EricssonInt/",
            //     completefunc: function(xData, Status){
            //         $(xData.responseXML).find("Group").each(function(){
            //             subjectGroups.push($(this));
            //             var groupName = $(this).attr("Name");
            //             $SP().groupMembers(groupName, function(members) {
            //                 for (var j = 0; j < members.length; j++) {
            //                     usersInGroup.push(members[j]);
            //                     console.log(usersInGroup[j]);
            //                 }
            //             });


            //         });
            //     }
            // });

            // $(document).ready(function(){

            //      for(var i = 0; i < subjectGroups.length; i++){
            //         console.log(subjectGroups[i].attr("Name"))

            //         if (!usersInGroup[i]){
            //             usersInGroup[i] = new Array();
            //         }

            //         $SP().groupMembers(subjectGroups[i].attr('Name'), function(members) {
            //             for (var j=0; j < members.length; j++) {
            //                 usersInGroup[i].push(members[j]);
            //                 console.log(usersInGroup[i][j]);
            //             }
            //         });
            //     }
            // });
           
            

        
    </script>
</body>

</html>
