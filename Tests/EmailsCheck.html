<iframe src="" frameborder="0"></iframe>
<!doctype html>
<html lang="en">
<!--
This version of the SP Mass deletion tool for users is adapted to work with most versions of SP 2010 and 2013
It uses asynchronous requests
-->

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Mass Deletion 2010-2013</title>
    <script type="text/javascript" src="https://googledrive.com/host/0B05gvY7cupTteG90ejJhVllWZ1k/jquery.js"></script>
    <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/themes/smoothness/jquery-ui.css" />
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
    <link rel="stylesheet" href="https://googledrive.com/host/0B05gvY7cupTtTnJfX2I1XzNtdkE/main.css">
    <link rel="stylesheet" href="https://googledrive.com/host/0B05gvY7cupTtTnJfX2I1XzNtdkE/normalize.css">
</head>

<body>
    <div>
        <div id="left">
            <textarea id="text" style="width:300px">vstoyanov@hp.com;martin.katsarski@hp.com;ericsson.account.pmo@hp.com</textarea>
            <button type="submit" id="submit">find</button>
        </div>
        <div id="right">
            <ul>
                <li>1 <span class="del" style="cursor:pointer">delete</span></li>
                <li>2 <span class="del" style="cursor:pointer">delete</span></li>
                <li>3 <span class="del" style="cursor:pointer">delete</span></li>
                <li>4 <span class="del" style="cursor:pointer">delete</span></li>
                <li>5 <span class="del" style="cursor:pointer">delete</span></li>
                <li>6 <span class="del" style="cursor:pointer">delete</span></li>
                <li id="del-all" style="cursor:pointer">delete all</li>
            </ul>
        </div>
    </div>
    <!--  <script type="text/javascript" src="https://googledrive.com/host/0B05gvY7cupTteG90ejJhVllWZ1k/jquery-ui.js"></script>
    <link rel="stylesheet" href="https://googledrive.com/host/0B05gvY7cupTtTnJfX2I1XzNtdkE/jquery-ui.css"> 
      -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.7.1/modernizr.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery-csv/0.71/jquery.csv-0.71.min.js"></script>
    <script type="text/javascript" src="https://googledrive.com/host/0B05gvY7cupTteG90ejJhVllWZ1k/jquery.SPServices.min.js"></script>
    <script type="text/javascript" src="https://googledrive.com/host/0B05gvY7cupTteG90ejJhVllWZ1k/sharepointplus.js"></script>
    <script>
    	//checks if emails is valid
    	var users = [];
	    var invalidUsers = [];
	    var emails = "";
	    $("#submit").click(function() {
	        emails = $("#text").val();
	        emails = emails.split(";");
	        for (var i = 0; i < emails.length; i++) {
	            var email = emails[i];
	            $SP().people(email, {
	                url: "http://ent261.sharepoint.hp.com/teams/EricssonInt"
	            }, function(people) {
	                if (typeof people === "string") {
	                    invalidUsers.push(email)
	                } else {
	                    users.push(people);
	                }
	            });
	        }
	    });


	    //delete on the fly
	    $('#del-all').click(function(e) {
	        e.preventDefault();
	        $(this).closest('ul').remove();
	    });
	    $('.del').click(function(e) {
	        e.preventDefault();
	        $(this).closest('li').remove();
	    });
    </script>
</body>

</html>
